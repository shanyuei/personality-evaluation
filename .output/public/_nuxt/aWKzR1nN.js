import{_ as de}from"./Bhf2ykJ7.js";import{_ as me,U as J,a as Q}from"./B4XhZWx6.js";import{H as pe,c as O,I as G,J as ve,K as X,L as Y,M as Z,r as I,y as ee,D as ye,N as V,O as he,g as K,C as F,P as ge,Q as _e,l as be,o as ne,w as U,R as Ee,S as we,n as Ie,p as S,T as Se,U as xe,V as Fe,d as Oe,u as Ue,f as je,a as Be,b as N,i as w,t as T,q as Ne,m as te,k as $e,s as ke}from"./DYacvIsm.js";import{u as qe}from"./B6O6kb_K.js";import{U as Ae}from"./C8q6hq62.js";import"./Cgfdd8G0.js";function Ve(s){return"schema"in s&&typeof s.coercer=="function"&&typeof s.validator=="function"&&typeof s.refiner=="function"}function Te(s){return"~standard"in s}async function Ce(s,r){const i=await r["~standard"].validate(s);return i.issues?{errors:i.issues?.map(n=>({name:n.path?.map(u=>typeof u=="object"?u.key:u).join(".")||"",message:n.message}))||[],result:null}:{errors:null,result:i.value}}async function Ke(s,r){const[i,n]=r.validate(s);return i?{errors:i.failures().map(v=>({message:v.message,name:v.path.join(".")})),result:null}:{errors:null,result:n}}function Re(s,r){if(Te(r))return Ce(s,r);if(Ve(r))return Ke(s,r);throw new Error("Form validation failed: Unsupported form schema")}function De(s,r){return r?r.split(".").reduce((n,u)=>n?.[u],s):s}function Me(s,r,i){if(!r)return Object.assign(s,i);if(!s)return s;const n=r.split(".");let u=s;for(let c=0;c<n.length-1;c++){const f=n[c];(u[f]===void 0||u[f]===null)&&(c+1<n.length&&!Number.isNaN(Number(n[c+1]))?u[f]=[]:u[f]={}),u=u[f]}const v=n[n.length-1];return u[v]=i,s}class $ extends Error{formId;errors;constructor(r,i){super("Form validation exception"),this.formId=r,this.errors=i,Object.setPrototypeOf(this,$.prototype)}}const Le={base:""},Pe={__name:"UForm",props:{id:{type:[String,Number],required:!1},schema:{type:null,required:!1},state:{type:null,required:!1},validate:{type:Function,required:!1},validateOn:{type:Array,required:!1,default(){return["input","blur","change"]}},disabled:{type:Boolean,required:!1},name:{type:null,required:!1},validateOnInputDelay:{type:Number,required:!1,default:300},transform:{type:null,required:!1,default:()=>!0},nested:{type:Boolean,required:!1},loadingAuto:{type:Boolean,required:!1,default:!0},class:{type:null,required:!1},onSubmit:{type:Function,required:!1}},emits:["submit","error"],setup(s,{expose:r,emit:i}){const n=s,u=i,v=pe(),c=O(()=>G({extend:G(Le),...v.ui?.form||{}})),f=n.id??ve(),g=qe(`form-${f}`),y=n.nested===!0&&X(Y,void 0),j=n.nested===!0?X(Z,void 0):void 0,_=O(()=>j?.value?n.name?De(j.value,n.name):j.value:n.state);F(Y,g),F(Z,_);const b=I(new Map);ee(async()=>{y&&(await ye(),y.emit({type:"attach",validate:B,formId:f,name:n.name,api:H}))}),he(()=>{g.reset(),y&&y.emit({type:"detach",formId:f})}),ee(async()=>{g.on(async e=>{e.type==="attach"?b.value.set(e.formId,{validate:e.validate,name:e.name,api:e.api}):e.type==="detach"?b.value.delete(e.formId):n.validateOn?.includes(e.type)&&!E.value&&(e.type!=="input"?await B({name:e.name,silent:!0,nested:!1}):(e.eager||C.has(e.name))&&await B({name:e.name,silent:!0,nested:!1})),e.type==="blur"&&C.add(e.name),(e.type==="change"||e.type==="input"||e.type==="blur"||e.type==="focus")&&R.add(e.name),(e.type==="change"||e.type==="input")&&q.add(e.name)})});const l=I([]);F(xe,l);const k=I({});F(Fe,k);const q=K(new Set),R=K(new Set),C=K(new Set);function D(e){return e.map(t=>({...t,id:t?.name?k.value[t.name]?.id:void 0}))}const A=I(null);async function ae(){let e=n.validate?await n.validate(_.value)??[]:[];if(n.schema){const{errors:t,result:a}=await Re(_.value,n.schema);t?e=e.concat(t):A.value=a}return D(e)}async function B(e={silent:!1,nested:!1,transform:!1}){const t=e.name&&!Array.isArray(e.name)?[e.name]:e.name;let a=[],o=[];if(!t&&e.nested){const h=Array.from(b.value.values()).map(p=>se(p,e)),m=await Promise.all(h);o=m.filter(p=>p.error).flatMap(p=>p.error.errors.map(fe=>re(fe,p.name))),a=m.filter(p=>p.output!==void 0)}const x=[...await ae(),...o];if(t?l.value=le(x,t):l.value=x,l.value?.length){if(e.silent)return!1;throw new $(f,l.value)}return e.transform?(a.forEach(h=>{h.name?Me(A.value,h.name,h.output):Object.assign(A.value,h.output)}),A.value??_.value):_.value}const E=I(!1);F(ge,V(E));async function M(e){E.value=n.loadingAuto&&!0;const t=e;try{t.data=await B({nested:!0,transform:n.transform}),await n.onSubmit?.(t),q.clear()}catch(a){if(!(a instanceof $))throw a;const o={...t,errors:a.errors};u("error",o)}finally{E.value=!1}}const L=O(()=>n.disabled||E.value);F(_e,O(()=>({disabled:L.value,validateOnInputDelay:n.validateOnInputDelay})));async function se(e,t){try{const a=await e.validate({...t,silent:!1});return{name:e.name,output:a}}catch(a){if(!(a instanceof $))throw a;return{name:e.name,error:a}}}function re(e,t){return!t||!e.name?e:{...e,name:t+"."+e.name}}function oe(e,t){const a=t+".",o=e?.name?.startsWith(a)?e.name.substring(a.length):e.name;return{...e,name:o}}function ie(e,t){return t?e.filter(a=>a?.name?.startsWith(t+".")).map(a=>oe(a,t)):e}function P(e){return e.api.getErrors().map(t=>e.name?{...t,name:e.name+"."+t.name}:t)}function W(e,t){return!e||!t?!0:e instanceof RegExp?e.test(t):t===e||typeof e=="string"&&e.startsWith(t+".")}function ue(e,t){if(!e||e instanceof RegExp)return e;if(t!==e)return typeof e=="string"&&e.startsWith(t+".")?e.substring(t.length+1):e}function le(e,t){const a=new Set(t),o=t.map(m=>k.value?.[m]?.pattern).filter(Boolean),d=m=>m.name?a.has(m.name)?!0:o.some(p=>p.test(m.name)):!1,x=l.value.filter(m=>!d(m)),h=e.filter(d);return[...x,...h]}function ce(e,t){return e.filter(a=>t instanceof RegExp?!(a.name&&t.test(a.name)):!a.name||a.name!==t)}function z(e){return!e.name||!!k.value[e.name]}const H={validate:B,errors:l,setErrors(e,t){const a=D(e.filter(z)),o=[];for(const d of b.value.values())if(W(t,d.name)){const x=ie(e,d.name);d.api.setErrors(x,ue(t,d.name||"")),o.push(...P(d))}if(t){const d=ce(l.value,t);l.value=[...d,...a,...o]}else l.value=[...a,...o]},async submit(){await M(new Event("submit"))},getErrors(e){return e?l.value.filter(t=>e instanceof RegExp?t.name&&e.test(t.name):t.name===e):l.value},clear(e){const t=e?l.value.filter(o=>z(o)&&(e instanceof RegExp?!(o.name&&e.test(o.name)):o.name!==e)):[],a=[];for(const o of b.value.values())W(e,o.name)&&o.api.clear(),a.push(...P(o));l.value=[...t,...a]},disabled:L,loading:E,dirty:O(()=>!!q.size),dirtyFields:V(q),blurredFields:V(C),touchedFields:V(R)};return r(H),(e,t)=>(ne(),be(Se(S(y)?"div":"form"),{id:S(f),class:Ie(c.value({class:n.class})),onSubmit:we(M,["prevent"])},{default:U(()=>[Ee(e.$slots,"default",{errors:l.value,loading:E.value})]),_:3},40,["id","class"]))}},We={class:"uno-relative uno-flex uno-items-center uno-justify-center uno-py-24 sm:uno-py-32"},ze={class:"uno-w-full uno-max-w-[720px] uno-px-6 sm:uno-px-10"},He={class:"uno-rounded-[24px] uno-p-8 sm:uno-p-10"},Je={class:"uno-text-center uno-mb-10 uno-text-[#0F172A] uno-font-['Outfit'] uno-font-bold uno-text-4xl sm:uno-text-5xl"},Qe={class:"uno-flex uno-items-center uno-justify-between uno-mt-6"},Ge={class:"uno-text-[#8d8e8f] uno-font-['Outfit']"},Xe=Oe({__name:"sign-in",setup(s){const{t:r}=Ue();je({title:()=>r("seo.auth.signIn.title"),description:()=>r("seo.auth.signIn.description")});const i=I(""),n=I(""),u=O(()=>{const c=i.value.trim(),f=n.value.trim();return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c)&&!!f}),v=()=>{u.value&&console.log("Sign in attempt",{email:i.value})};return(c,f)=>{const g=de,y=me,j=Ne,_=Pe,b=$e;return ne(),Be("div",We,[N("div",ze,[N("div",He,[N("h1",Je,T(c.$t("pages.auth.signIn.title")),1),w(_,{state:{email:i.value,password:n.value},class:"uno-space-y-6"},{default:U(()=>[w(y,{label:c.$t("pages.account.settings.profile.emailPlaceholder"),ui:S(J)},{default:U(()=>[w(g,{modelValue:i.value,"onUpdate:modelValue":f[0]||(f[0]=l=>i.value=l),type:"email",placeholder:c.$t("pages.account.settings.profile.emailPlaceholder"),ui:S(Q)},null,8,["modelValue","placeholder","ui"])]),_:1},8,["label","ui"]),w(y,{label:c.$t("pages.auth.signIn.passwordLabel"),ui:S(J)},{default:U(()=>[w(g,{modelValue:n.value,"onUpdate:modelValue":f[1]||(f[1]=l=>n.value=l),type:"password",placeholder:c.$t("pages.auth.signIn.passwordPlaceholder"),ui:S(Q)},null,8,["modelValue","placeholder","ui"])]),_:1},8,["label","ui"]),w(j,{ui:S(Ae),color:"primary",disabled:!u.value,onClick:v},{default:U(()=>[te(T(c.$t("pages.auth.signIn.submit")),1)]),_:1},8,["ui","disabled"])]),_:1},8,["state"]),N("div",Qe,[N("p",Ge,T(c.$t("pages.auth.signIn.noAccount")),1),w(b,{to:"/auth/sign-up",class:"uno-text-[#0F172A] hover:uno-text-[#4E5255] uno-font-['Outfit'] uno-underline uno-underline-offset-4"},{default:U(()=>[te(T(c.$t("pages.auth.signIn.signUp")),1)]),_:1})])])])])}}}),st=ke(Xe,[["__scopeId","data-v-dbf60b43"]]);export{st as default};
