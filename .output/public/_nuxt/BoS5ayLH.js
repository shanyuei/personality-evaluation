import{_ as de}from"./CAJFDZwk.js";import{_ as me,U as J,a as Q}from"./Cf_UcQoX.js";import{J as pe,c as O,K as X,L as ve,M as G,N as Y,O as Z,r as S,H as ee,P as ye,Q as T,I as he,q as K,R as B,S as ge,T as _e,A as be,o as ne,B as j,U as Ee,k as we,n as Ie,y as x,V as Se,W as xe,X as Fe,d as Ue,u as Be,p as Oe,f as je,g as k,h as I,t as V,D as $e,C as te,a as ke,l as qe,m as Ae}from"./vQvnemwP.js";import{u as Ne}from"./C78JLuCZ.js";import{_ as Te}from"./BOZOmdZC.js";import{U as Ve}from"./C8q6hq62.js";import{u as Ce}from"./BvK6Rsou.js";import"./OBX0wJqx.js";import"./DHzwNi16.js";function Ke(s){return"schema"in s&&typeof s.coercer=="function"&&typeof s.validator=="function"&&typeof s.refiner=="function"}function Pe(s){return"~standard"in s}async function Re(s,i){const c=await i["~standard"].validate(s);return c.issues?{errors:c.issues?.map(n=>({name:n.path?.map(o=>typeof o=="object"?o.key:o).join(".")||"",message:n.message}))||[],result:null}:{errors:null,result:c.value}}async function De(s,i){const[c,n]=i.validate(s);return c?{errors:c.failures().map(v=>({message:v.message,name:v.path.join(".")})),result:null}:{errors:null,result:n}}function Le(s,i){if(Pe(i))return Re(s,i);if(Ke(i))return De(s,i);throw new Error("Form validation failed: Unsupported form schema")}function Me(s,i){return i?i.split(".").reduce((n,o)=>n?.[o],s):s}function We(s,i,c){if(!i)return Object.assign(s,c);if(!s)return s;const n=i.split(".");let o=s;for(let y=0;y<n.length-1;y++){const r=n[y];(o[r]===void 0||o[r]===null)&&(y+1<n.length&&!Number.isNaN(Number(n[y+1]))?o[r]=[]:o[r]={}),o=o[r]}const v=n[n.length-1];return o[v]=c,s}class q extends Error{formId;errors;constructor(i,c){super("Form validation exception"),this.formId=i,this.errors=c,Object.setPrototypeOf(this,q.prototype)}}const ze={base:""},He={__name:"UForm",props:{id:{type:[String,Number],required:!1},schema:{type:null,required:!1},state:{type:null,required:!1},validate:{type:Function,required:!1},validateOn:{type:Array,required:!1,default(){return["input","blur","change"]}},disabled:{type:Boolean,required:!1},name:{type:null,required:!1},validateOnInputDelay:{type:Number,required:!1,default:300},transform:{type:null,required:!1,default:()=>!0},nested:{type:Boolean,required:!1},loadingAuto:{type:Boolean,required:!1,default:!0},class:{type:null,required:!1},onSubmit:{type:Function,required:!1}},emits:["submit","error"],setup(s,{expose:i,emit:c}){const n=s,o=c,v=pe(),y=O(()=>X({extend:X(ze),...v.ui?.form||{}})),r=n.id??ve(),d=Ne(`form-${r}`),h=n.nested===!0&&G(Y,void 0),F=n.nested===!0?G(Z,void 0):void 0,b=O(()=>F?.value?n.name?Me(F.value,n.name):F.value:n.state);B(Y,d),B(Z,b);const E=S(new Map);ee(async()=>{h&&(await ye(),h.emit({type:"attach",validate:$,formId:r,name:n.name,api:H}))}),he(()=>{d.reset(),h&&h.emit({type:"detach",formId:r})}),ee(async()=>{d.on(async e=>{e.type==="attach"?E.value.set(e.formId,{validate:e.validate,name:e.name,api:e.api}):e.type==="detach"?E.value.delete(e.formId):n.validateOn?.includes(e.type)&&!w.value&&(e.type!=="input"?await $({name:e.name,silent:!0,nested:!1}):(e.eager||C.has(e.name))&&await $({name:e.name,silent:!0,nested:!1})),e.type==="blur"&&C.add(e.name),(e.type==="change"||e.type==="input"||e.type==="blur"||e.type==="focus")&&P.add(e.name),(e.type==="change"||e.type==="input")&&A.add(e.name)})});const l=S([]);B(xe,l);const g=S({});B(Fe,g);const A=K(new Set),P=K(new Set),C=K(new Set);function R(e){return e.map(t=>({...t,id:t?.name?g.value[t.name]?.id:void 0}))}const N=S(null);async function ae(){let e=n.validate?await n.validate(b.value)??[]:[];if(n.schema){const{errors:t,result:a}=await Le(b.value,n.schema);t?e=e.concat(t):N.value=a}return R(e)}async function $(e={silent:!1,nested:!1,transform:!1}){const t=e.name&&!Array.isArray(e.name)?[e.name]:e.name;let a=[],u=[];if(!t&&e.nested){const _=Array.from(E.value.values()).map(p=>se(p,e)),m=await Promise.all(_);u=m.filter(p=>p.error).flatMap(p=>p.error.errors.map(fe=>re(fe,p.name))),a=m.filter(p=>p.output!==void 0)}const U=[...await ae(),...u];if(t?l.value=le(U,t):l.value=U,l.value?.length){if(e.silent)return!1;throw new q(r,l.value)}return e.transform?(a.forEach(_=>{_.name?We(N.value,_.name,_.output):Object.assign(N.value,_.output)}),N.value??b.value):b.value}const w=S(!1);B(ge,T(w));async function D(e){w.value=n.loadingAuto&&!0;const t=e;try{t.data=await $({nested:!0,transform:n.transform}),await n.onSubmit?.(t),A.clear()}catch(a){if(!(a instanceof q))throw a;const u={...t,errors:a.errors};o("error",u)}finally{w.value=!1}}const L=O(()=>n.disabled||w.value);B(_e,O(()=>({disabled:L.value,validateOnInputDelay:n.validateOnInputDelay})));async function se(e,t){try{const a=await e.validate({...t,silent:!1});return{name:e.name,output:a}}catch(a){if(!(a instanceof q))throw a;return{name:e.name,error:a}}}function re(e,t){return!t||!e.name?e:{...e,name:t+"."+e.name}}function oe(e,t){const a=t+".",u=e?.name?.startsWith(a)?e.name.substring(a.length):e.name;return{...e,name:u}}function ie(e,t){return t?e.filter(a=>a?.name?.startsWith(t+".")).map(a=>oe(a,t)):e}function M(e){return e.api.getErrors().map(t=>e.name?{...t,name:e.name+"."+t.name}:t)}function W(e,t){return!e||!t?!0:e instanceof RegExp?e.test(t):t===e||typeof e=="string"&&e.startsWith(t+".")}function ue(e,t){if(!e||e instanceof RegExp)return e;if(t!==e)return typeof e=="string"&&e.startsWith(t+".")?e.substring(t.length+1):e}function le(e,t){const a=new Set(t),u=t.map(m=>g.value?.[m]?.pattern).filter(Boolean),f=m=>m.name?a.has(m.name)?!0:u.some(p=>p.test(m.name)):!1,U=l.value.filter(m=>!f(m)),_=e.filter(f);return[...U,..._]}function ce(e,t){return e.filter(a=>t instanceof RegExp?!(a.name&&t.test(a.name)):!a.name||a.name!==t)}function z(e){return!e.name||!!g.value[e.name]}const H={validate:$,errors:l,setErrors(e,t){const a=R(e.filter(z)),u=[];for(const f of E.value.values())if(W(t,f.name)){const U=ie(e,f.name);f.api.setErrors(U,ue(t,f.name||"")),u.push(...M(f))}if(t){const f=ce(l.value,t);l.value=[...f,...a,...u]}else l.value=[...a,...u]},async submit(){await D(new Event("submit"))},getErrors(e){return e?l.value.filter(t=>e instanceof RegExp?t.name&&e.test(t.name):t.name===e):l.value},clear(e){const t=e?l.value.filter(u=>z(u)&&(e instanceof RegExp?!(u.name&&e.test(u.name)):u.name!==e)):[],a=[];for(const u of E.value.values())W(e,u.name)&&u.api.clear(),a.push(...M(u));l.value=[...t,...a]},disabled:L,loading:w,dirty:O(()=>!!A.size),dirtyFields:T(A),blurredFields:T(C),touchedFields:T(P)};return i(H),(e,t)=>(ne(),be(Se(x(h)?"div":"form"),{id:x(r),class:Ie(y.value({class:n.class})),onSubmit:we(D,["prevent"])},{default:j(()=>[Ee(e.$slots,"default",{errors:l.value,loading:w.value})]),_:3},40,["id","class"]))}},Je={class:"uno-relative uno-flex uno-items-center uno-justify-center uno-py-24 sm:uno-py-32"},Qe={class:"uno-w-full uno-max-w-[720px] uno-px-6 sm:uno-px-10"},Xe={class:"uno-rounded-[24px] uno-p-8 sm:uno-p-10"},Ge={class:"uno-text-center uno-mb-10 uno-text-[#0F172A] uno-font-['Outfit'] uno-font-bold uno-text-4xl sm:uno-text-5xl"},Ye={class:"uno-flex uno-items-center uno-justify-between uno-mt-6"},Ze={class:"uno-text-[#8d8e8f] uno-font-['Outfit']"},et=Ue({__name:"sign-in",setup(s){const{t:i}=Be();Oe({title:()=>i("seo.auth.signIn.title"),description:()=>i("seo.auth.signIn.description")});const c=Ce(),n=S(""),o=S(""),v=O(()=>{const r=n.value.trim(),d=o.value.trim();return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)&&!!d}),y=()=>{v.value&&c.login({email:n.value,password:o.value}).then(()=>{const r=ke();qe(r("/"))})};return(r,d)=>{const h=de,F=me,b=$e,E=He,l=Te;return ne(),je("div",Je,[k("div",Qe,[k("div",Xe,[k("h1",Ge,V(r.$t("pages.auth.signIn.title")),1),I(E,{state:{email:n.value,password:o.value},class:"uno-space-y-6"},{default:j(()=>[I(F,{label:r.$t("pages.account.settings.profile.emailPlaceholder"),ui:x(J)},{default:j(()=>[I(h,{modelValue:n.value,"onUpdate:modelValue":d[0]||(d[0]=g=>n.value=g),type:"email",placeholder:r.$t("pages.account.settings.profile.emailPlaceholder"),ui:x(Q)},null,8,["modelValue","placeholder","ui"])]),_:1},8,["label","ui"]),I(F,{label:r.$t("pages.auth.signIn.passwordLabel"),ui:x(J)},{default:j(()=>[I(h,{modelValue:o.value,"onUpdate:modelValue":d[1]||(d[1]=g=>o.value=g),type:"password",placeholder:r.$t("pages.auth.signIn.passwordPlaceholder"),ui:x(Q)},null,8,["modelValue","placeholder","ui"])]),_:1},8,["label","ui"]),I(b,{ui:x(Ve),color:"primary",disabled:!v.value,onClick:y},{default:j(()=>[te(V(r.$t("pages.auth.signIn.submit")),1)]),_:1},8,["ui","disabled"])]),_:1},8,["state"]),k("div",Ye,[k("p",Ze,V(r.$t("pages.auth.signIn.noAccount")),1),I(l,{to:"/auth/sign-up",class:"uno-text-[#0F172A] hover:uno-text-[#4E5255] uno-font-['Outfit'] uno-underline uno-underline-offset-4"},{default:j(()=>[te(V(r.$t("pages.auth.signIn.signUp")),1)]),_:1})])])])])}}}),ct=Ae(et,[["__scopeId","data-v-e007c91e"]]);export{ct as default};
